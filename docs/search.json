[
  {
    "objectID": "blog.html",
    "href": "blog.html",
    "title": "Blog",
    "section": "",
    "text": "Arrowtown air quality\n\n\n\n\n\n\ncode\n\n\nair quality\n\n\nanimation\n\n\n\n\n\n\n\n\n\nJun 2, 2024\n\n\nIsaac Bain\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#welcome-to-my-personal-website.",
    "href": "index.html#welcome-to-my-personal-website.",
    "title": "Kia ora üëã",
    "section": "Welcome to my personal website.",
    "text": "Welcome to my personal website.\nThis is where I share my projects, maps, graphs, and code that I‚Äôve been tinkering with. You‚Äôll hopefully some interesting content here about environmental data, freshwater ecology, and public health.\nPlease remember, nothing here represents the views of my employer‚Äîit‚Äôs all just my personal work and thoughts. My goal is to make complex data more accessible and even a bit fun. I aim to provide insights and provoke thought rather than deliver definitive conclusions.\nI hope you find something intriguing and valuable on my site. Feel free to reach out with any questions or comments.\nNgƒÅ mihi,\nIsaac Bain"
  },
  {
    "objectID": "posts/arrowtown-air-quality/index.html",
    "href": "posts/arrowtown-air-quality/index.html",
    "title": "Arrowtown air quality",
    "section": "",
    "text": "Most of the time, New Zealand enjoys good air quality, allowing us to step outside and breathe a breath of fresh air, knowing it‚Äôs safe. However at certain times and places, our air is polluted to such levels that it causes us harm, or in the worst cases, premature death. Here I access air quality data from LAWA and explore it for one site known for severe winter air pollution."
  },
  {
    "objectID": "posts/arrowtown-air-quality/index.html#libraries",
    "href": "posts/arrowtown-air-quality/index.html#libraries",
    "title": "Arrowtown air quality",
    "section": "1 Libraries",
    "text": "1 Libraries\n\n\nShow the code\nlibrary(tidyverse) # provides ggplot, dplyr, etc\nlibrary(janitor) # tidy up messy variable names\nlibrary(gganimate) # provides animations\nlibrary(geomtextpath) # makes labels curved on polar graph\nlibrary(leaflet) # for interactive mapping"
  },
  {
    "objectID": "posts/arrowtown-air-quality/index.html#import-data",
    "href": "posts/arrowtown-air-quality/index.html#import-data",
    "title": "Arrowtown air quality",
    "section": "2 Import data",
    "text": "2 Import data\nLand, Air, Water Aotearoa (LAWA) is a collaboration between New Zealand‚Äôs 16 regional councils and unitary authorities, the Cawthron Institute, the Ministry for the Environment, the Department of Conservation, and Stats NZ. LAWA provides state of the environment monitoring data for various environmental domains, including; swimming water quality, estuary health, groundwater quality, lake quality, land cover, river quality, water quantity, and of particular interest here, air quality.\nLAWA makes their data freely available at https://lawa.org.nz/download-data. From this source I downloaded an Excel sheet of air quality data for the period 2016 to 2022. Currently, the available parameters are PM10 and PM2.5.\nParticulate matter (PM) can have adverse effects on human health and the environment. The numbers 10 and 2.5 refer to the diameter of the particles in micrometers (¬µm).\n\n\n\n\n\n\nWhat are the human health impacts of PM in New Zealand?\n\n\n\n\n\nHales et al.¬†(2021) did a retrospective cohort epidemiological study of the association between PM2.5, NO2 and mortality and morbidity for 2.2m New Zealanders. They found that exposure to PM2.5 per 10 Œºg/m3 increased the risk of death by 11% (95% CI 7-15%) and increased the risk of ischaemic heart disease by 29% (95% CI 23-35%).\nHales, S., Atkinson, J., Metcalfe, J., Kuschel, G., & Woodward, A. (2021). Long term exposure to air pollution, mortality and morbidity in New Zealand: cohort study. Science of The Total Environment, 801, 149660.\n\n\n\n\n\nShow the code\ndat &lt;- readxl::read_xlsx(\"data/airqualitydownloaddata_2016-2022.xlsx\",\n                         sheet = \"Air Quality Data\") |&gt; # read in data\n  clean_names() |&gt; # tidy up messy names\n  mutate(year = year(sample_date)) |&gt; # extract year as a new variable\n  filter(!is.na(sample_date) & !is.na(concentration)) # filter out NAs"
  },
  {
    "objectID": "posts/arrowtown-air-quality/index.html#what-are-the-worst-sites",
    "href": "posts/arrowtown-air-quality/index.html#what-are-the-worst-sites",
    "title": "Arrowtown air quality",
    "section": "3 What are the worst sites?",
    "text": "3 What are the worst sites?\nAir quality is known to be worst in more southern areas, places where home heating via wood burning or coal is more prevalent, particularly during the colder months of the year.\nBut let‚Äôs check some of these assumptions by extracting the worst 5 sites for highest recorded PM10 values (Table¬†1).\n\n\nShow the code\ndat |&gt; \n  filter(indicator == \"PM10\") |&gt; # just look at PM10\n  group_by(site_name) |&gt; \n  summarize(max_concentration = max(concentration, na.rm = TRUE)) |&gt; # get max conc. per site\n  arrange(desc(max_concentration)) |&gt; # sort descending\n  top_n(5, max_concentration) |&gt; # get top 5 sites\n  knitr::kable()\n\n\n\n\nTable¬†1: Top 5 sites with highest PM10 concentrations\n\n\n\n\n\n\nsite_name\nmax_concentration\n\n\n\n\nMilton\n202.800\n\n\nArrowtown\n157.900\n\n\nLower Hutt (Phil Evans Reserve)\n155.400\n\n\nInvercargill at Pomona Street\n138.980\n\n\nWashdyke Alpine\n123.496\n\n\n\n\n\n\n\n\nIndeed most of these locations are in South Island, with the exception of Lower Hutt, which is at the southern end of the North Island.\n\n\nShow the code\nprocessed_data &lt;- dat %&gt;% \n  filter(indicator == \"PM10\") %&gt;% # just look at PM10\n  group_by(site_name) %&gt;% \n  summarise(\n    max_concentration = max(concentration, na.rm = TRUE), \n    latitude = first(latitude),\n    longitude = first(longitude)\n  ) %&gt;% # get max conc. per site\n  arrange(desc(max_concentration)) %&gt;% # sort descending\n  top_n(5, max_concentration) %&gt;% \n  sf::st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326)\n\n# Create a color palette\npal &lt;- colorNumeric(\n  palette = \"YlOrRd\",\n  domain = processed_data$max_concentration, # Set the domain to the range of max_concentration\n  na.color = \"transparent\",\n  reverse = TRUE\n)\n\n# Create a Leaflet map\nleaflet(processed_data) %&gt;%\n  addTiles() %&gt;%\n  addCircleMarkers(\n    radius = ~sqrt(max_concentration), # Scale the radius proportional to max_concentration\n    color = ~pal(max_concentration),\n    fillOpacity = 1,\n    stroke = 0,\n    label = ~paste0(site_name, \", \", \"Max PM10: \", max_concentration)\n  ) %&gt;%\n  addLegend(\n    \"bottomright\",\n    pal = pal,\n    values = processed_data$max_concentration, # Pass the actual max_concentration values\n    title = \"Max PM10 Concentration\",\n    opacity = 0.7,\n    labFormat = labelFormat(transform = function(x) sort(x, decreasing = TRUE))\n  )"
  },
  {
    "objectID": "posts/arrowtown-air-quality/index.html#static-plot-of-seasonal-air-quality",
    "href": "posts/arrowtown-air-quality/index.html#static-plot-of-seasonal-air-quality",
    "title": "Arrowtown air quality",
    "section": "4 Static plot of seasonal air quality",
    "text": "4 Static plot of seasonal air quality\nNow let‚Äôs check the assumption that air quality is worse during the colder months of the year. Here, I plot daily PM10 concentrations over 2022 for one site (Arrowtown) (Figure¬†1). The data shows a significant spike during the winter months, with a number of exceedances of the WHO guideline of 45 ¬µg/m¬≥.\n\n\nShow the code\ndat_filtered &lt;- dat |&gt; \n  filter(site_name == \"Arrowtown\") |&gt; \n  filter(indicator == \"PM10\") |&gt; \n  filter(year == 2022) |&gt;\n  arrange(sample_date) |&gt; \n  mutate(sample_date = as.Date(sample_date))\n\n# Calculate the breaks for y-axis labels\nn_breaks &lt;- 5\nmy_breaks &lt;- scales::breaks_extended(n = n_breaks)(range(dat_filtered$concentration))\nmy_breaks &lt;- my_breaks[my_breaks &gt; 0]\n\n# Create a data frame for the tick marks\ntick_data &lt;- data.frame(\n  x = as.Date(\"2022-01-01\"),\n  xend = as.Date(\"2022-01-03\"),\n  y = my_breaks,\n  yend = my_breaks\n)\n\n# plot\nggplot(dat_filtered) +\n  geom_hline(yintercept = 45, linetype = \"dashed\", color = \"red\", alpha = 0.7) +\n  geom_line(aes(x = sample_date, y = concentration),\n            color = \"#D72638\",\n            size = 0.5) +\n  scale_x_date(date_labels = \"%b\", date_breaks = \"1 month\") +\n  labs(\n    title = bquote(\"Daily PM\"[10] * \" concentration (¬µg/m\"^3 * \") in Arrowtown, 2022\"),\n    x = \"\",\n    y = bquote(\"Daily PM\"[10] * \" concentration (¬µg/m\"^3 * \")\")\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5, \n                              colour = \"#420039\"),\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    axis.text.x = element_text(\n      color = \"#12355B\",\n      face = \"bold\",\n      size = 14,\n      vjust = -0.5\n    )\n  ) +\n  annotate(\n    'text',\n    x = as.Date(\"2022-01-03\"),\n    y = my_breaks,\n    label = round(my_breaks, 2),\n    angle = 0,\n    hjust = -0.1,\n    vjust = 0.5\n  ) +\n  geom_segment(data = tick_data,\n               aes(\n                 x = x,\n                 xend = xend,\n                 y = y,\n                 yend = yend\n               ),\n               color = \"black\")\n\n\n\n\n\n\n\n\nFigure¬†1: PM10 daily concentrations at Arrowtown, 2022. Dashed line shows WHO guideline value."
  },
  {
    "objectID": "posts/arrowtown-air-quality/index.html#make-an-animated-plot",
    "href": "posts/arrowtown-air-quality/index.html#make-an-animated-plot",
    "title": "Arrowtown air quality",
    "section": "5 Make an animated plot",
    "text": "5 Make an animated plot\nLet‚Äôs enhance our analysis by creating an animated polar chart that reveals the daily PM10 concentrations over time (Figure¬†2). This approach effectively highlights the cyclical nature of seasonal air quality. By animating the data, we can observe the progression of PM10 levels throughout the year, providing a clear visual representation of how air quality deteriorates during the winter months.\n\n\nShow the code\n# Define the start dates for each season according to New Zealand definitions\nseason_start_dates &lt;- as.Date(c(\"2022-12-01\", \"2022-03-01\", \"2022-06-01\", \"2022-09-01\"))\n\n# Create the plot with seasonal division lines and y-axis labels inside the chart\np &lt;- ggplot(dat_filtered) +\n  geom_hline(yintercept = 45, linetype = \"dashed\", color = \"red\", alpha = 0.7) +\n  geom_line(aes(x = sample_date, y = concentration),\n            color = \"#D72638\",\n            size = 0.5) +\n  geom_vline(\n    xintercept = as.numeric(season_start_dates),\n    linetype = \"dashed\",\n    color = \"black\",\n    alpha = 0.3\n  ) +\n  geom_point(aes(x = sample_date, y = concentration), color = \"#420039\", size = 2) +\n  scale_x_date(date_labels = \"%b\", date_breaks = \"1 month\") +\n  coord_curvedpolar() +\n  labs(\n    title = bquote(\"Daily PM\"[10] * \" concentration (¬µg/m\"^3 * \") in Arrowtown, 2022\"),\n    x = \"\",\n    y = \"\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5, \n                              colour = \"#420039\"),\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    axis.text.x = element_text(\n      color = \"#12355B\",\n      face = \"bold\",\n      size = 14,\n      vjust = -0.5\n    )\n  ) +\n  annotate(\n    'text',\n    x = as.Date(\"2022-01-03\"),\n    y = my_breaks,\n    label = round(my_breaks, 2),\n    angle = 0,\n    hjust = -0.1,\n    vjust = 0.5\n  ) +\n  geom_segment(data = tick_data,\n               aes(\n                 x = x,\n                 xend = xend,\n                 y = y,\n                 yend = yend\n               ),\n               color = \"black\") +\n  transition_reveal(sample_date) +\n  ease_aes('linear')  # Easing to make the animation smoother\n\n# Render the animation and save as GIF\nanim &lt;- animate(p, nframes = 100, fps = 10, renderer = gifski_renderer())\n\nanim\n\n\n\n\n\n\n\n\nFigure¬†2: Animated polar chart of PM10 daily concentrations at Arrowtown, 2022. Dashed circle shows WHO guideline value. Dashed lines show seasons."
  },
  {
    "objectID": "posts/arrowtown-air-quality/index.html#make-multiple-animated-plots",
    "href": "posts/arrowtown-air-quality/index.html#make-multiple-animated-plots",
    "title": "Arrowtown air quality",
    "section": "6 Make multiple animated plots",
    "text": "6 Make multiple animated plots\nNow let‚Äôs check out whether other high PM10 sites also have similar seasonal dynamics in air quality (we‚Äôll also use a different year to make sure) (Figure¬†3).\n\n\nShow the code\ntop_4 &lt;- dat |&gt; \n  filter(indicator == \"PM10\") |&gt; # just look at PM10\n  group_by(site_name) |&gt; \n  summarize(max_concentration = max(concentration, na.rm = TRUE)) |&gt; # get max conc. per site\n  arrange(desc(max_concentration)) |&gt; # sort descending\n  top_n(4, max_concentration)\n\np2 &lt;- dat |&gt; \n  filter(site_name %in% top_4$site_name) |&gt; \n  filter(indicator == \"PM10\") |&gt; \n  filter(year == 2019) |&gt;\n  arrange(sample_date) |&gt; \n  mutate(sample_date = as.Date(sample_date)) |&gt; \n  ggplot() +\n    geom_hline(yintercept = 45, linetype = \"dashed\", color = \"red\", alpha = 0.7) +\n    geom_line(aes(x = sample_date, y = concentration), color = \"#D72638\", size = 0.5) +\n    geom_point(aes(x = sample_date, y = concentration), color = \"#420039\", size = 2) +\n    scale_x_date(date_labels = \"%b\", date_breaks = \"1 month\") +\n    coord_curvedpolar() +\n    theme_minimal() +\n    labs(x = \"\", \n         y = bquote(\"Daily PM\"[10] * \" concentration (¬µg/m\"^3 * \")\")) +\n    transition_reveal(sample_date) +\n    ease_aes('linear') +\n    facet_wrap(~site_name, scales = \"free_y\")\n\n# Render the animation and save as GIF\nanim2 &lt;- animate(p2, nframes = 100, fps = 10, renderer = gifski_renderer())\n\nanim2\n\n\n\n\n\n\n\n\nFigure¬†3: Animated polar chart of PM10 daily concentrations at Arrowtown, Invercargill, Lower Hutt, and Milton, 2019. Dashed circle shows WHO guideline value. Note the y-axes differ between plots.\n\n\n\n\n\nSome interesting results here.1 Firstly, Arrowtown demonstrates similar seasonal dynamics to 2022, with low concentrations in summer and a number of exceedances during winter. Invercargill also shows similar seasonality, albeit at lower concentrations.\nLower Hutt remains well below the guideline all year-round, but exhibits reversed seasonality, with higher concentrations in summer. It‚Äôs worth noting that Lower Hutt is included in the top four due to a single large spike in 2022, so it might be reasonable to exclude this site from further analysis.\nMilton is particularly interesting as it has numerous exceedances during winter but appears not to monitor air quality during summer (this trend is true in other years as well)."
  },
  {
    "objectID": "posts/arrowtown-air-quality/index.html#next-steps",
    "href": "posts/arrowtown-air-quality/index.html#next-steps",
    "title": "Arrowtown air quality",
    "section": "7 Next steps",
    "text": "7 Next steps\nThis analysis has provided some interesting insights into the seasonality of PM10 concentrations in New Zealand. The next steps could involve:\n\nConduct a formal test for seasonality between sites\nClassify sites into categories such as ‚Äòhigh-summer‚Äô, ‚Äòhigh-winter‚Äô, ‚Äòhigh-all-year-round‚Äô, or ‚Äòlow‚Äô\nProduce animations for all sites on a map\nInvestigate causes of seasonality (latitude?)\nRepeat analyses for PM2.5\nPut multiple years on single graph"
  },
  {
    "objectID": "posts/arrowtown-air-quality/index.html#footnotes",
    "href": "posts/arrowtown-air-quality/index.html#footnotes",
    "title": "Arrowtown air quality",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nNote the y-axes differ between each site. This is due to the large magnitude in differences. My goal here was to explore the relative seasonality between each site, so having free axes makes sense. If the goal was instead to explore relative magnitudes between each site, I could have simply set facet_wrap(~site_name, scales = \"fixed\").‚Ü©Ô∏é"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Hi there! I‚Äôm a quantitative ecologist who loves working in environmental resource management. I dive into all sorts of tasks, from analysing raw data and generating insights, to developing policies, advising decision-makers, and building tools to help with implementation. I‚Äôm all about using open-source tools like R and making sure my analyses are reproducible.\nI call ≈åtautahi (Christchurch) home‚Äîa lovely little city. When I‚Äôm not working, you‚Äôll likely find me packrafting, paragliding, bikepacking, or sea kayaking.\nMost of my work focuses on freshwater ecosystems, but I‚Äôm also interested in how environmental health affects human health. I spend a lot of time at the intersection of science and policy, trying to bridge the gap between research and real-world applications.\nOn top of all that, I‚Äôm also a PhD candidate in Public Health at the University of Otago, continuing to learn and contribute to a new field."
  }
]